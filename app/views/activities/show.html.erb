<p>Name: <%= @activity.name %> </p>
<p>Location: <%= @activity.location %> </p>
<p> Date: <%= @activity.date %></p>
<p>Description: <%= @activity.description %> </p>
<p>User: <%= @activity.user.username %> </p>
<p>Category: <%= @activity.category.name %> </p>


<% if check_authorized(@activity, current_user) %>
<table>
  <thead>
    <th>Participant</th>
    <th>Status</th>
    <th>Edit Status</th>
  </thead>
  <tbody>
    <tr>
      <% @joined_activities.each do |joined_activity| %>
      <td> <%= joined_activity.user.username %> </td>
      <td> <%= joined_activity.status %> </td>
      <td> <%= simple_form_for [@activity, joined_activity] do |f| %>
        <%= f.input :status, collection: JoinedActivity::STATUS %>
        <%= f.submit %>
        <% end %>

      </td>
      <% end %>
    </tr>
  </tbody>
</table>
<% end %>

<p> <%= link_to 'Join activity', activity_joined_activities_path(@activity), method: :post %> </p>
<p> <%= link_to 'Go back to all activities', activities_path %> </p>


<table class="table">
  <thead>
    <tr>
      <th colspan="3"> Messages </th>
    </tr>
    <tr>
      <th colspan="1"> User </th>
      <th colspan="2"> Comment </th>
    </tr>
  </thead>
  <tbody>
    <% @all_messages. each do |message| %>
      <tr>
        <td colspan="1"> <%= message.user.username%></td>
        <td colspan="2"> <%= message.content %> </td>
      </tr>
    <% end  %>
  </tbody>
</table>

<br>

<% if current_user.nil? %>
  <p> Please sign in to leave a comment!</p>
  <% else %>
    <p> Please add your message below: </p>
      <%= simple_form_for [@activity, @message] do |f| %>
      <%= f.input :content %>
      <%= f.submit %>
    <% end %>
<% end %>
